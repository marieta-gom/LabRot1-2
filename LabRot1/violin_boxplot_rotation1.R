# Libraries
library(ggplot2)
library(dplyr)
library(hrbrthemes)
library(viridis)

## Data
data_dark_all <- c(172.960905,148.009905,160.697905,81.792905,278.251905,410.922333,26.752905,37.780905,64.940905,538.312905,58.678333,32.890333,126.342905,70.183905,80.815333,133.510905,45.400333,65.471905,41.217333,38.763905,26.960333,108.379905,32.013905,45.569333,184.554333,408.045333,107.212905,75.661905,40.169905,26.648905,194.430905,203.851905,162.327333,93.713333,20.898905,29.273333,26.231333,18.638333,560.292905,45.520905,53.674333,19.133905,15.415333,96.185905,166.974333,47.379333,99.633333,27.900905,40.690905,60.895333,186.329333,70.004905,61.383905,30.973905,37.103905,207.463333,62.614333,98.871333,28.820905,160.274905,56.052905,302.280905,34.349905,93.945333,242.467333,18.557333,115.663905,206.905905,324.902333,131.438905,326.567333,54.348905,59.267905,86.868905,46.314905,22.895905,90.439905,155.795333,149.855333,97.322905,51.913333,13.773333,84.245905,25.319905,69.862333,57.929905,10.732333,123.166333,62.067333,89.764905,38.450905,26.031905,112.945905,54.584905,91.564905,29.805333,300.927333,173.018333,86.604333,42.787905,27.972,52.104,217.373,9.285,125.269,126.066,31.355,549.949,46.039,111.986,16.016,117.112,38.195,70.577,5.921,155.517,22.564,23.113,10.705,41.401,37.988,117.053,22.673,5.006,297.276,3.72,27.842,7.392,21.621,23.67,21.777,65.117,24.191,457.074,478.024,43.21,25.027,254.676,18.527,193.019,13.177,88.693,297.371,201.781,63.165,7.446,8.808,58.288,152.322,65.04,34.32,64.65,12.71,196.45,42.07,63.64,164.92,271.8,182.25,8.38,66.96,32.04,27.97,145.56,142.87,59.36,18.07,50.53,9.5,102.36,32.81,41.51,52.04,10.59,65.5,120.49,40.73,60.4,34.16,7.27,238.7,11.32,152.41,16.77,60.21,350.26,38.87,240.02,8.06,32.26,26.18,146.36,233.7,26.51,32.53,197.85,14.11,168.97,14.29,39.25)
data_light_all <- c(48.80119,146.45119,854.171556,255.673556,40.00619,226.109556,197.73019,25.00219,109.093191,488.772191,320.75219,529.802191,80.78019,17.53319,32.657556,26.728556,113.87719,159.69519,324.595191,277.03819,34.94319,136.357191,46.78919,120.54419,60.317556,54.04319,680.03619,48.761556,22.904556,19.04519,143.44419,665.134191,39.55519,23.413556,61.587556,107.16019,104.379191,603.757556,93.85819,43.02019,68.71319,96.662556,353.270191,28.80519,116.284556,319.133556,22.70919,86.59919,74.15819,120.25519,568.752556,81.157556,7.429556,727.97019,226.130556,20.54119,48.15519,122.337191,141.03419,238.329191,22.77119,20.936556,36.75519,19.936556,42.32419,467.73319,35.96619,182.514191,65.78219,29.519556,23.30819,106.447556,16.671556,113.65319,408.25019,327.34319,298.61219,448.85519,96.786556,131.180191,44.39919,38.402556,338.515556,185.18419,501.71419,283.534556,129.10619,91.59619,291.66319,96.786556,336.977191,91.14619,565.12319,795.26719,143.33719,120.46619,143.045556,29.451556,27.040556,148.06519,403.66,48.56,18.907,176.467,8.234,19.465,286.276,33.351,109.528,14.099,4.916,216.37,11.784,34.977,27.155,57.566,25.482,7.125,537.143,26.852,59.691,84.583,174.109,11.844,57.6,22.372,8.623,298.256,74.103,5.674,11.163,273.226,92.396,19.092,25.251,19.493,19.053,367.866,149.511,21.588,44.062,17.637,229.719,21.956,41.536,9.675,79.982,133.125,11.267,273.103,84.695,173.176,16.199,84.112,20.007,173.152,10.678,39.011,430.566,46.992,57.459,205.723,156.802,16.253,483.977,237.179,30.816,163.288,23.931,189.556,170.881,31.98,170.806,61.949,77.338,51.471,27.561,75.136,64.95,71.802,14.515,319.05,135.133,13.306,4.537,105.433,26.07,401.398,190.103,52.132,86.4,5.779,297.189,432.082,20.887,19.018,170.115,166.676,198.663,104.512)

data_dark_living <- c(41.21733333, 166.9743333, 184.4953333, 29.80533333, 69.86233333, 93.94533333, 207.4633333, 66.59133333, 45.56933333, 36.12333333, 300.9273333, 149.8553333, 62.06733333, 24.57133333, 162.3273333, 18.63833333, 173.0183333, 410.9223333, 60.89533333, 14.15533333, 29.27333333, 32.89033333, 51.91333333, 47.88433333, 41.04733333, 86.60433333, 53.67433333, 26.96033333, 19.94133333, 324.9023333, 326.5673333, 62.61433333, 242.4673333, 408.0453333, 90.36933333, 98.87133333, 47.32333333, 48.61533333, 58.67833333, 80.81533333, 47.37933333, 186.3293333, 89.47533333, 31.47933333, 26.23133333, 18.55733333, 43.42433333, 19.85533333, 93.71333333, 44.08033333, 184.5543333, 60.20133333, 14.65533333, 15.41533333, 99.63333333, 13.77333333, 10.73233333, 123.1663333, 45.40033333, 155.7953333, 165.4553333, 57.92990476, 54.34890476, 131.4389048, 61.38390476, 115.6639048, 112.9459048, 70.00490476, 65.47190476, 19.40090476, 81.79290476, 153.6729048, 40.69090476, 126.3429048, 39.06290476, 38.76390476, 91.56490476, 77.03890476, 84.24590476, 38.45090476, 28.82090476, 53.48490476, 160.2749048, 151.6769048, 302.2809048, 97.32290476, 127.3729048, 95.64390476, 148.0099048, 64.94090476, 37.21090476, 30.31890476, 37.78090476, 75.66190476, 278.2519048, 107.2129048, 40.16990476, 19.13390476, 26.03190476, 26.75290476, 34.34990476, 133.5109048, 160.6979048, 48.75290476, 538.3129048, 560.2929048, 90.43990476, 121.6299048, 62.17390476, 203.8519048, 37.10390476, 30.97390476, 152.1959048, 89.76490476, 206.9059048, 25.31990476, 42.78790476, 201.8529048, 194.4309048, 59.26790476, 32.01390476, 27.90090476, 54.58490476, 46.31490476, 56.05290476, 86.86890476, 45.52090476, 108.3799048, 172.9609048, 26.64890476, 28.29590476, 96.18590476, 123.8569048, 70.18390476, 20.89890476, 22.89590476)
data_light_living <- c(603.7575556, 89.43155556, 106.4475556, 155.2635556, 81.15755556, 21.74655556, 363.6555556, 103.6435556, 55.82255556, 116.2845556, 149.8535556, 162.1425556, 226.1095556, 48.76155556, 246.2985556, 72.62855556, 319.1335556, 22.90455556, 60.31755556, 96.78655556, 31.02455556, 47.51955556, 336.0065556, 96.78655556, 31.02455556, 47.51955556, 336.0065556, 42.64555556, 40.84955556, 16.67155556, 7.429555556, 156.6085556, 36.57055556, 104.0185556, 29.51955556, 61.58755556, 612.2115556, 26.72855556, 21.67655556, 71.84655556, 45.35555556, 568.7525556, 66.38155556, 96.66255556, 316.9095556, 283.5345556, 226.1305556, 255.6735556, 15.18455556, 47.95355556, 250.3655556, 64.98955556, 143.0455556, 29.45155556, 23.41355556, 338.5155556, 20.93655556, 19.93655556, 20.10755556, 27.04055556, 38.40255556, 32.65755556, 854.1715556, 158.4715556, 17.88919048, 795.2671905, 488.7721905, 336.9771905, 159.6951905, 70.14419048, 146.4511905, 23.92719048, 291.6631905, 565.1231905, 328.5591905, 501.7141905, 141.0341905, 120.5441905, 40.00619048, 727.9701905, 252.7981905, 500.7431905, 123.9821905, 71.38519048, 107.1601905, 113.8771905, 476.8741905, 46.15719048, 63.56419048, 335.8121905, 665.1341905, 448.8551905, 120.4661905, 36.08019048, 91.59619048, 327.3431905, 277.0381905, 214.4271905, 185.1841905, 123.5151905, 142.2841905, 120.2551905, 181.5951905, 62.84419048, 121.0421905, 29.91019048, 408.2501905, 48.80119048, 36.75519048, 31.82519048, 20.54119048, 136.3571905, 93.85819048, 47.49219048, 107.3581905, 84.16819048, 47.18719048, 324.5951905, 298.6121905, 175.4721905, 467.7331905, 320.7521905, 25.00219048, 208.3461905, 244.4461905, 42.32419048, 204.3031905, 119.9611905, 65.78219048, 578.7751905, 143.3371905, 57.40219048, 43.02019048, 19.04519048, 48.15519048, 67.44819048, 131.1801905, 28.69219048, 91.14619048, 260.0711905, 353.2701905, 214.6851905, 109.0931905, 529.8021905, 204.6451905, 122.3371905, 86.59919048, 23.30819048, 44.74919048, 295.2261905, 72.43019048, 238.3291905, 74.65419048, 92.87719048, 45.11719048, 29.61719048, 39.55519048, 136.8601905, 104.3791905, 35.96619048, 680.0361905, 68.71319048, 197.7301905, 22.70919048, 66.52819048, 17.53319048, 22.77119048, 10.30319048, 6.861190476, 148.0651905, 143.4441905, 80.78019048, 44.39919048, 97.78519048, 182.5141905, 54.04319048, 74.15819048, 113.6531905, 7.811190476, 28.80519048, 129.1061905, 27.83619048, 34.94319048, 46.78919048)


data_dark_fixed <- c(144.20, 196.45, 145.56, 233.70, 240.02, 9.50, 43.09, 35.81, 16.77, 60.40, 26.51, 9.36, 64.65, 14.29, 10.59, 5.82, 7.27, 34.16, 141.20, 39.25, 238.70, 271.80, 146.36, 55.77, 32.53, 14.11, 12.71, 40.73, 23.60, 38.61, 8.38, 9.48, 52.04, 238.60, 152.41, 27.97, 50.53, 119.80, 142.87, 19.22, 73.14, 197.85, 350.26, 120.49, 38.87, 27.03, 60.21, 26.18, 32.26, 32.04, 37.51, 182.25, 164.92, 300.66, 8.06, 41.51, 42.27, 63.64, 10.09, 42.07, 22.60, 11.32, 10.06, 168.97, 158.78, 18.07, 59.36, 32.81, 66.96, 65.50, 102.36, 78.97, 51.97, 34.32, 56.9385, 41.4005, 18.5265, 7.4455, 117.1115, 58.2875, 38.1945, 21.7765, 31.3545, 3.7195, 155.5165, 27.972, 478.024, 8.619, 7.392, 117.053, 9.285, 457.074, 282.708, 22.929, 22.815, 27.842, 16.016, 65.117, 152.322, 46.039, 23.460, 549.949, 218.837, 63.165, 13.177, 43.210, 5.006, 88.693, 254.676, 297.276, 8.808, 201.781, 297.371, 23.113, 23.670, 48.1615, 70.5765, 22.5635, 10.7045, 126.0655, 125.2685, 72.8005, 12.4935, 8.2555, 21.6205, 217.3725, 193.0185, 25.0265, 111.9855, 52.1035, 24.1905, 65.0395, 5.9205, 22.9065, 37.9875, 22.6725)
data_light_fixed <- c(27.561, 16.253, 14.899, 26.487, 29.873, 47.962, 51.471, 42.014, 190.103, 56.701, 470.855, 86.400, 170.115, 20.887, 33.254, 24.448, 205.723, 297.189, 15.545, 38.117, 46.992, 104.512, 13.306, 169.705, 14.153, 21.426, 198.663, 430.566, 236.258, 26.070, 4.537, 14.515, 23.931, 4.447, 170.806, 118.992, 10.292, 21.073, 211.013, 189.556, 77.338, 71.802, 148.122, 39.011, 20.007, 233.688, 173.152, 31.444, 170.881, 156.802, 31.980, 84.112, 84.695, 105.433, 163.288, 34.471, 30.816, 5.779, 33.169, 35.908, 21.174, 319.050, 199.296, 483.977, 432.082, 64.950, 242.250, 22.668, 88.767, 19.018, 21.455, 16.135, 23.463, 52.132, 174.212, 29.582, 237.179, 173.176, 6.843, 145.574, 57.459, 29.110, 16.199, 75.136, 58.010, 166.676, 135.133, 61.949, 220.263, 10.678, 62.715, 401.398, 19.053, 8.234, 34.977, 22.372, 4.916, 57.566, 11.844, 537.143, 209.131, 26.852, 19.465, 48.560, 25.251, 403.660, 229.719, 27.155, 57.600, 109.528, 216.370, 11.267, 5.674, 7.125, 14.099, 174.1088333, 17.42483333, 21.95583333, 20.99883333, 95.40983333, 17.63683333, 149.5108333, 367.8658333, 1477.425833, 25.48183333, 42.81783333, 19.09183333, 41.53583333, 11.16283333, 9.799833333, 74.10283333, 8.622833333, 18.90683333, 176.4668333, 133.1248333, 298.2558333, 273.1028333, 84.58283333, 92.39583333, 11.78383333, 9.674833333, 273.2258333, 64.01783333, 19.49283333, 79.98183333, 286.2758333, 44.06183333, 21.58783333, 33.35083333, 59.69083333)


#Subset samples

n <- 200 #size of the subset

subset_light <- sample(data_light_all, n, replace = T)
subset_dark <- sample(data_dark_all, n, replace = T)

#Create dataset

dataframe <- data.frame(condition=c(rep("Light",n), rep("Dark",n)),fluorescence=c(subset_light, subset_dark))

# sample size
sample_size = dataframe %>% group_by(condition) %>% summarize(num=n())

# Plot
#dataframe %>%
 # left_join(sample_size) %>%
  #mutate(myaxis = paste0(condition, "\n", "n=", num)) %>%
  #ggplot( aes(x=myaxis, y=fluorescence, fill=condition)) +
  #geom_violin(width=1) +
  #geom_dotplot(binaxis='y', stackdir='center', dotsize=0.5) +
  #geom_boxplot(width=0.1, color="grey", alpha=0.2) +
  #scale_fill_viridis(discrete = TRUE) +
  #theme_ipsum() +
  #theme(
   # legend.position="none",
    #plot.title = element_text(size=11)
#  ) +
 # ggtitle("DeLux expression") +
  #xlab("") +
  #stat_summary(fun.y=mean, geom="point", shape=23, size=2, color = "red")

dataframe %>%
  left_join(sample_size) %>%
  mutate(Condition = paste0(condition, "\n", "n=", num)) %>%
  ggplot(aes(x=Condition, y=fluorescence, color=condition), ) + 
  scale_color_manual(values=c("black", "#E69F00"))+
  labs(title="DeLux",
       x ="Condition", y = "mCherry fluorescence [a.u.]") +
  geom_violin(linewidth = 0.6) + 
 # geom_dotplot(binaxis='y', stackdir='center', dotsize=0.4, color = "grey") +
  geom_jitter(shape=20, position=position_jitter(0.2), color ="#A9A9A9") +
  geom_boxplot(width=0.1, color="black", alpha=0.2, outlier.shape = NA) +
  stat_summary(fun.y=mean, geom="point", shape=18, size=3) +
  theme_bw() +
  theme(
    plot.title = element_text(size = 16),
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    axis.text = element_text(size = 11, color = "black")
  )

#Get some stats from the dataset
## Calculate mean, standard deviation, and median for both datasets
mean_light <- mean(subset_light)
mean_dark <- mean(subset_dark)

sd_light <- sd(subset_light)
sd_dark <- sd(subset_dark)

median_light <- median(subset_light)
median_dark <- median(subset_dark)

## Print the results
cat(paste("For the light subset (n =", n,"):\n 
          Mean:", mean_light, "\n
          Standard Deviation:", sd_light, "\n
          Median:", median_light, "\n\n
          For the dark subset (n =", n,"):\n
          Mean:", mean_dark, "\n
          Standard Deviation:", sd_dark, "\n
          Median:", median_dark, "\n")
    )


###########################################__BOOTSTRAPPING__###################################################

# Initialize an empty vector to store the means
bootstr_means_dark <- numeric(1000)
bootstr_means_light <- numeric(1000)
bootstr_SD_dark <- numeric(1000)
bootstr_SD_light <- numeric(1000)

a <- 100

# Loop 1000 times
for (i in 1:1000) {
  # Sample 200 values from your_dataframe
  subset_i_dark <- sample(data_dark_fixed, a, replace = T)
  subset_i_light <- sample(data_light_fixed, a, replace = T)
  
  # Calculate the mean of the sampled values
  bootstr_means_dark[i] <- mean(subset_i_dark)
  bootstr_means_light[i] <- mean(subset_i_light)
  bootstr_SD_dark[i] <- sd(subset_i_dark)
  bootstr_SD_light[i] <- sd(subset_i_light)
}

# Calculate the standard deviation of the 100 means
mean_means_dark <- mean(bootstr_means_dark)
mean_means_light <- mean(bootstr_means_light)
sd_means_dark <- sd(bootstr_means_dark)
sd_means_light <- sd(bootstr_means_light)

mean_SD_dark <- mean(bootstr_SD_dark)
mean_SD_light <- mean(bootstr_SD_light)
sd_SD_dark <- sd(bootstr_SD_dark)
sd_SD_light <- sd(bootstr_SD_light)

# Print the result
cat("For 1000 bootstrapping cycles of random samples (N =", a, "each):
      Dark:
      Mean:", mean_means_dark, "+-", sd_means_dark, "
      SD:", mean_SD_dark, "+-", sd_SD_dark, 
    
      "Light:
      Mean", mean_means_light, "+-", sd_means_light,
      "SD:", mean_SD_light, "+-", sd_SD_light)
